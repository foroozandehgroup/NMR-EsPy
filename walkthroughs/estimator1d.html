<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Using Estimator1D &#8212; NMR-EsPy 2.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d7e2fa82" />
    <link rel="stylesheet" type="text/css" href="../_static/nameko.css?v=2296cfae" />
    <script src="../_static/documentation_options.js?v=20623aea"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Estimator2DJ" href="estimator2dj.html" />
    <link rel="prev" title="Tutorials" href="index.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Lora:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="estimator2dj.html" title="Using Estimator2DJ"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Tutorials"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">NMR-EsPy 2.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Tutorials</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using <code class="docutils literal notranslate"><span class="pre">Estimator1D</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="using-estimator1d">
<span id="estimator1d"></span><h1>Using <code class="docutils literal notranslate"><span class="pre">Estimator1D</span></code><a class="headerlink" href="#using-estimator1d" title="Link to this heading">¶</a></h1>
<p>The <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D" title="nmrespy.Estimator1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">nmrespy.Estimator1D</span></code></a> class is provided for the consideration of 1D NMR data.</p>
<section id="generating-an-instance">
<h2>Generating an instance<a class="headerlink" href="#generating-an-instance" title="Link to this heading">¶</a></h2>
<p>There are a few ways to create a new instance of the estimator depending on the source of the data.</p>
<section id="bruker-data">
<h3>Bruker data<a class="headerlink" href="#bruker-data" title="Link to this heading">¶</a></h3>
<p>It is possible to load both raw FID data and processed spectral data from
Bruker using <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.new_bruker" title="nmrespy.Estimator1D.new_bruker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_bruker()</span></code></a>. All that is needed is
the path to the dataset:</p>
<ol class="arabic">
<li><p>If you wish to import an FID, set the path as <code class="docutils literal notranslate"><span class="pre">&quot;&lt;path_to_data&gt;/&lt;expno&gt;/&quot;</span></code>.
There should be an <code class="docutils literal notranslate"><span class="pre">fid</span></code> file and an <code class="docutils literal notranslate"><span class="pre">acqus</span></code> file directly under this
directory. The data in the <code class="docutils literal notranslate"><span class="pre">fid</span></code> file will be imported, and the artefact
from digital filtering will be removed by a first-order phase shift.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you import FID data, there is a high chance that you will need to
phase the data, and apply baseline correction before proceeding to run
estimation. Look at <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.phase_data" title="nmrespy.Estimator1D.phase_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">phase_data()</span></code></a> and
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.baseline_correction" title="nmrespy.Estimator1D.baseline_correction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">baseline_correction()</span></code></a>, respectively.</p>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">nmrespy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ne</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">Estimator1D</span><span class="o">.</span><span class="n">new_bruker</span><span class="p">(</span><span class="s2">&quot;/home/simon/nmr_data/andrographolide/1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">phase_data</span><span class="p">(</span><span class="n">p0</span><span class="o">=</span><span class="mf">2.653</span><span class="p">,</span> <span class="n">p1</span><span class="o">=-</span><span class="mf">5.686</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="mi">13596</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">baseline_correction</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>To import processed data, set the path as
<code class="docutils literal notranslate"><span class="pre">&quot;&lt;path_to_data&gt;/&lt;expno&gt;/pdata/&lt;procno&gt;&quot;</span></code>. There should be a <code class="docutils literal notranslate"><span class="pre">1r</span></code> file
and a <code class="docutils literal notranslate"><span class="pre">procs</span></code> file directly under this directory. The data in <code class="docutils literal notranslate"><span class="pre">1r</span></code> will
be Inverse Fourier Transformed, and the resulting time-domain signal is sliced
so that only the first half is retained.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It can be more convienient to provide processed data, even though the
data will be converted to the time-domain for estimation, as you can
then rely on TopSpin’s automated processing scripts to phase and
baseline correct. However, <strong>you should not apply any window function to
the data other than exponential line broadening.</strong></p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">nmrespy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ne</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">Estimator1D</span><span class="o">.</span><span class="n">new_bruker</span><span class="p">(</span><span class="s2">&quot;home/simon/nmr_data/andrographolide/1/pdata/1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note there is no need for extra data-processing steps</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="simulated-data-from-a-set-of-signal-parameters">
<h3>Simulated data from a set of signal parameters<a class="headerlink" href="#simulated-data-from-a-set-of-signal-parameters" title="Link to this heading">¶</a></h3>
<p>You can create an estimator with synthetic data constructed from known
parameters using <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.new_from_parameters" title="nmrespy.Estimator1D.new_from_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_from_parameters()</span></code></a>.
The parameters must be provided as a 2D NumPy array with <code class="docutils literal notranslate"><span class="pre">params.shape[1]</span> <span class="pre">==</span>
<span class="pre">4</span></code>. Each row should contain a signal’s amplitude, phase (rad), frequency
(Hz), and damping factor (s⁻¹).</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">nmrespy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ne</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using frequencies of 2,3-Dibromopropanoic acid @ 500MHz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1864.4</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1855.8</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1844.2</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1835.6</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1981.4</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1961.2</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1958.8</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1938.6</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2265.6</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2257.0</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2243.0</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2234.4</span><span class="p">,</span> <span class="mf">7.</span><span class="p">],</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfo</span> <span class="o">=</span> <span class="mf">500.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">Estimator1D</span><span class="o">.</span><span class="n">new_from_parameters</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pts</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>  <span class="c1"># FID made with 2048 points</span>
<span class="gp">... </span>    <span class="n">sw</span><span class="o">=</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">sfo</span><span class="p">,</span>  <span class="c1"># sweep width set to 1.2 ppm</span>
<span class="gp">... </span>    <span class="n">offset</span><span class="o">=</span><span class="mf">4.1</span> <span class="o">*</span> <span class="n">sfo</span><span class="p">,</span>  <span class="c1"># transmitter offset set to 4.1 ppm</span>
<span class="gp">... </span>    <span class="n">sfo</span><span class="o">=</span><span class="n">sfo</span><span class="p">,</span>  <span class="c1"># transmitter frequecy set to 500 MHz</span>
<span class="gp">... </span>    <span class="n">snr</span><span class="o">=</span><span class="mf">40.</span><span class="p">,</span>  <span class="c1"># signal-to-noise ratio of the FID set to 40 dB</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the rest of this section, we will be using the estimator created in
the above code snippet.</p>
</div>
</section>
<section id="simulated-data-from-spinach">
<h3>Simulated data from Spinach<a class="headerlink" href="#simulated-data-from-spinach" title="Link to this heading">¶</a></h3>
<p>Assuming you have installed the <a class="reference internal" href="../install.html#spinach-install"><span class="std std-ref">relevant requirements</span></a>,
you can create an estimator instance with data simulated using Spinach with
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.new_spinach" title="nmrespy.Estimator1D.new_spinach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_spinach()</span></code></a>. The spin system is defined by a
specification of isotropic chemical shifts and scalar couplings:</p>
<ul class="simple">
<li><p>For the chemical shifts, a list of floats is required.</p></li>
<li><p>For J-couplings, a list with 3-element tuples of the form <code class="docutils literal notranslate"><span class="pre">(spin1,</span> <span class="pre">spin2,</span>
<span class="pre">coupling)</span></code> is required. <strong>N.B. the spin indices start at ``1`` rather than
``0``</strong>.</p></li>
</ul>
<p>It can take some time to run this function is it involves (a) starting up
MATLAB and (b) running a simulation of the experiment.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">nmrespy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ne</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2,3-Dibromopropanoic acid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.7</span><span class="p">,</span> <span class="mf">3.92</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">couplings</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sfo</span> <span class="o">=</span> <span class="mf">500.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">Estimator1D</span><span class="o">.</span><span class="n">new_spinach</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">shifts</span><span class="o">=</span><span class="n">shifts</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">couplings</span><span class="o">=</span><span class="n">couplings</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">pts</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sw</span><span class="o">=</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">sfo</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">offset</span><span class="o">=</span><span class="mf">4.1</span> <span class="o">*</span> <span class="n">sfo</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sfo</span><span class="o">=</span><span class="n">sfo</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="viewing-and-accessing-the-dataset">
<h2>Viewing and accessing the dataset<a class="headerlink" href="#viewing-and-accessing-the-dataset" title="Link to this heading">¶</a></h2>
<p>You can inspect the data associated with the estimator with
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.view_data" title="nmrespy.Estimator1D.view_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">view_data()</span></code></a>, which loads an interactive
matplotlib figure:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">view_data</span><span class="p">(</span><span class="n">freq_unit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/estimator_1d_view_data.png" class="align-center" src="../_images/estimator_1d_view_data.png" />
<p>You can access the time-domain data with the
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.data" title="nmrespy.Estimator1D.data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data()</span></code></a> property,
and the associated time-points can be retrieved using
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.get_timepoints" title="nmrespy.Estimator1D.get_timepoints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_timepoints()</span></code></a>.  The spectral data is accessed
with <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.spectrum" title="nmrespy.Estimator1D.spectrum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum()</span></code></a>, and the corresponding chemical
shifts with <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.get_shifts" title="nmrespy.Estimator1D.get_shifts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_shifts()</span></code></a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fid</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_timepoints</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_shifts</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">fid</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="go">[&lt;matplotlib.lines.Line2D object at 0x7f2c0e0aa680&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$t$ (s)&quot;</span><span class="p">)</span>
<span class="go">Text(0.5, 0, &#39;$t$ (s)&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shifts</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="go">[&lt;matplotlib.lines.Line2D object at 0x7f2c0e0aa8c0&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Flip x-axis limits (ensure plotting from high to low shifts)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()))</span>
<span class="go">(4.759384765624999, 3.4400292968749997)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$^1$H (ppm)&quot;</span><span class="p">)</span>
<span class="go">Text(0.5, 0, &#39;$^1$H (ppm)&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The exact appearence of the generated figure may slightly differ to</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the one below; that&#39;ll just be due to customisations I have made to mpl.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/fid_spec.png" class="align-center" src="../_images/fid_spec.png" />
</section>
<section id="estimating-the-dataset">
<h2>Estimating the dataset<a class="headerlink" href="#estimating-the-dataset" title="Link to this heading">¶</a></h2>
<p>The generation of parameter estimates is facilitated using the
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.estimate" title="nmrespy.Estimator1D.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a> method. In most scenarios,
it will not be computationally feasible to estimate the entire FID at once, due
to the number of constituent datapoints and signals. For this reason, NMR-EsPy generates
frequency-filtered “sub-FIDs” to break the problem down into more manageable
chunks. To create suitable sub-FIDs, it is important to select regions in which
all signals of interest fully reside within its bounds. As well as this, a
region that is devoid of signals (the “noise region”) must be indicated. In the
figure below, the red region would be inappropriate as the signals clearly do
not reside within it fully. The green region is acceptable, as the signals do
abide by this. Finally, the grey region is a suitable noise region as it only
comprises points in the baseline.</p>
<img alt="../_images/good_bad_noise_regions.png" class="align-center" src="../_images/good_bad_noise_regions.png" />
<p>For our dataset, we will estimate three regions, encompassing each multiplet
structure in the spectrum. Each region must be given as a tuple of 2 floats,
specifying the left and right boundaries of the region of interest (the order
of these doesn’t matter). By default, these are assumed to be given in Hz,
unless <code class="docutils literal notranslate"><span class="pre">region_unit</span></code> is set to <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regions</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">4.6</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">),</span> <span class="p">(</span><span class="mf">4.02</span><span class="p">,</span> <span class="mf">3.82</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_region</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.3</span><span class="p">,</span> <span class="mf">4.25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">estimator</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">noise_region</span><span class="o">=</span><span class="n">noise_region</span><span class="p">,</span> <span class="n">region_unit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">...</span>
<span class="go">┌─────────────────────────────────────┐</span>
<span class="go">│ESTIMATING REGION: 4.6 - 4.4 ppm (F1)│</span>
<span class="go">└─────────────────────────────────────┘</span>
<span class="go">┌───────────┐</span>
<span class="go">│MPM STARTED│</span>
<span class="go">└───────────┘</span>
<span class="go">--&gt; Pencil Parameter: 125</span>
<span class="go">--&gt; Hankel data matrix constructed:</span>
<span class="go">    Size:   251 x 126</span>
<span class="go">    Memory: 0.4826MiB</span>
<span class="go">--&gt; Performing Singular Value Decomposition...</span>
<span class="go">--&gt; Computing number of oscillators...</span>
<span class="go">    Number of oscillators will be estimated using MDL</span>
<span class="go">    Number of oscillations: 4</span>
<span class="go">--&gt; Computing signal poles...</span>
<span class="go">--&gt; Computing complex amplitudes...</span>
<span class="go">--&gt; Checking for oscillators with negative damping...</span>
<span class="go">    None found</span>
<span class="go">┌────────────┐</span>
<span class="go">│MPM COMPLETE│</span>
<span class="go">└────────────┘</span>
<span class="go">Time elapsed: 0 mins, 0 secs, 45 msecs</span>
<span class="go">┌────────────────────┐</span>
<span class="go">│OPTIMISATION STARTED│</span>
<span class="go">└────────────────────┘</span>
<span class="go">┌───────────────────────────┐</span>
<span class="go">│TRUST NCG ALGORITHM STARTED│</span>
<span class="go">└───────────────────────────┘</span>
<span class="go">┌───────┬──────────────┬──────────────┬──────────────┐</span>
<span class="go">│ Iter. │  Objective   │  Grad. Norm  │ Trust Radius │</span>
<span class="go">├───────┼──────────────┼──────────────┼──────────────┤</span>
<span class="go">│ 0     │ 0.0106245    │ 0.0653396    │ 1            │</span>
<span class="go">│ 6     │ 0.00529026   │ 4.06591e-09  │ 1            │</span>
<span class="go">└───────┴──────────────┴──────────────┴──────────────┘</span>
<span class="go">Optimiser successfully converged.</span>
<span class="go">┌────────────────────────────┐</span>
<span class="go">│TRUST NCG ALGORITHM COMPLETE│</span>
<span class="go">└────────────────────────────┘</span>
<span class="go">Time elapsed: 0 mins, 0 secs, 34 msecs</span>
<span class="go">┌─────────────────────┐</span>
<span class="go">│OPTIMISATION COMPLETE│</span>
<span class="go">└─────────────────────┘</span>
<span class="go">Time elapsed: 0 mins, 0 secs, 101 msecs</span>
<span class="go">┌───────────────────────────────────────┐</span>
<span class="go">│ESTIMATING REGION: 4.02 - 3.82 ppm (F1)│</span>
<span class="go">└───────────────────────────────────────┘</span>

<span class="go">--snip--</span>

<span class="go">┌─────────────────────────────────────┐</span>
<span class="go">│ESTIMATING REGION: 3.8 - 3.6 ppm (F1)│</span>
<span class="go">└─────────────────────────────────────┘</span>

<span class="go">--snip--</span>
</pre></div>
</div>
</section>
<section id="inspecting-estimation-results">
<h2>Inspecting estimation results<a class="headerlink" href="#inspecting-estimation-results" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Result indices</strong></p>
<p>Each time the <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.estimate" title="nmrespy.Estimator1D.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a> method is called, the
result is appended to a list containing all the generated results. For many
methods that make use of estimation results, an argument called <code class="docutils literal notranslate"><span class="pre">indices</span></code>
exists. This lets you specify the results you are interested in. By default
(<code class="docutils literal notranslate"><span class="pre">indices</span> <span class="pre">=</span> <span class="pre">None</span></code>) all results will be used. A subset of the results can
be considered by including a
list of integers. For example <code class="docutils literal notranslate"><span class="pre">indices</span> <span class="pre">=</span> <span class="pre">[0,</span> <span class="pre">2]</span></code> would mean only the 1st
and 3rd results acquired with the estimator are considered.</p>
</div>
<p>A NumPy array of the generated results can be acquired using
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.get_params" title="nmrespy.Estimator1D.get_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_params()</span></code></a>. The corresponding errors associated
with the signal parameters are obtained with <a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.get_errors" title="nmrespy.Estimator1D.get_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_errors()</span></code></a>.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># All params, frequencies in Hz:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<span class="go">[[ 1.0018e+00  1.5921e-03  1.8356e+03  7.0187e+00]</span>
<span class="go"> [ 1.0003e+00  2.4881e-03  1.8442e+03  6.9968e+00]</span>
<span class="go"> [ 1.0024e+00  1.5817e-03  1.8558e+03  7.0281e+00]</span>
<span class="go"> [ 1.0008e+00  9.1591e-04  1.8644e+03  7.0007e+00]</span>
<span class="go"> [ 1.0022e+00  7.1936e-04  1.9386e+03  7.0109e+00]</span>
<span class="go"> [ 9.9470e-01 -7.4609e-04  1.9588e+03  6.9866e+00]</span>
<span class="go"> [ 1.0080e+00 -1.0112e-03  1.9612e+03  7.0448e+00]</span>
<span class="go"> [ 1.0009e+00 -7.1398e-04  1.9814e+03  7.0131e+00]</span>
<span class="go"> [ 1.0003e+00  1.1306e-03  2.2344e+03  7.0095e+00]</span>
<span class="go"> [ 1.0011e+00  6.0150e-04  2.2430e+03  7.0011e+00]</span>
<span class="go"> [ 9.9902e-01  2.8231e-04  2.2570e+03  6.9856e+00]</span>
<span class="go"> [ 1.0004e+00 -1.8229e-03  2.2656e+03  7.0057e+00]]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All errors, frequencies in Hz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_errors</span><span class="p">()</span>
<span class="go">[[0.0013 0.0013 0.0019 0.0121]</span>
<span class="go"> [0.0014 0.0014 0.002  0.0124]</span>
<span class="go"> [0.0014 0.0014 0.002  0.0125]</span>
<span class="go"> [0.0013 0.0013 0.0019 0.012 ]</span>
<span class="go"> [0.0012 0.0012 0.0018 0.0114]</span>
<span class="go"> [0.0036 0.0036 0.0034 0.0212]</span>
<span class="go"> [0.0036 0.0036 0.0034 0.0213]</span>
<span class="go"> [0.0012 0.0012 0.0018 0.0114]</span>
<span class="go"> [0.0013 0.0013 0.0019 0.0116]</span>
<span class="go"> [0.0013 0.0013 0.0019 0.0118]</span>
<span class="go"> [0.0013 0.0013 0.0019 0.0118]</span>
<span class="go"> [0.0013 0.0013 0.0018 0.0116]]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Params for first region, frequencies in ppm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">funit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">)</span>
<span class="go">[[ 1.0003e+00  1.1306e-03  4.4688e+00  7.0095e+00]</span>
<span class="go"> [ 1.0011e+00  6.0150e-04  4.4860e+00  7.0011e+00]</span>
<span class="go"> [ 9.9902e-01  2.8231e-04  4.5140e+00  6.9856e+00]</span>
<span class="go"> [ 1.0004e+00 -1.8229e-03  4.5312e+00  7.0057e+00]]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Params for second and third regions, split up</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">merge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">funit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">)</span>
<span class="go">[array([[ 1.0022e+00,  7.1936e-04,  3.8772e+00,  7.0109e+00],</span>
<span class="go">       [ 9.9470e-01, -7.4609e-04,  3.9176e+00,  6.9866e+00],</span>
<span class="go">       [ 1.0080e+00, -1.0112e-03,  3.9224e+00,  7.0448e+00],</span>
<span class="go">       [ 1.0009e+00, -7.1398e-04,  3.9628e+00,  7.0131e+00]]),</span>
<span class="go"> array([[1.0018e+00, 1.5921e-03, 3.6712e+00, 7.0187e+00],</span>
<span class="go">       [1.0003e+00, 2.4881e-03, 3.6884e+00, 6.9968e+00],</span>
<span class="go">       [1.0024e+00, 1.5817e-03, 3.7116e+00, 7.0281e+00],</span>
<span class="go">       [1.0008e+00, 9.1591e-04, 3.7288e+00, 7.0007e+00]])]</span>
</pre></div>
</div>
<section id="writing-result-tables">
<h3>Writing result tables<a class="headerlink" href="#writing-result-tables" title="Link to this heading">¶</a></h3>
<p>Tables of parameters can be saved to <code class="docutils literal notranslate"><span class="pre">.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> formats. using
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.write_result" title="nmrespy.Estimator1D.write_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_result()</span></code></a>. For PDF generation, you will
need a working LaTeX installation. See the <a class="reference internal" href="../install.html#latex-install"><span class="std std-ref">installation instructions</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">estimator</span><span class="o">.</span><span class="n">write_result</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;tutorial_1d&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Simulated 2,3-Dibromopropanoic acid signal.&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">...</span>
<span class="go">Saved file tutorial_1d.txt.</span>
<span class="go">Saved file tutorial_1d.tex.</span>
<span class="go">Saved file tutorial_1d.pdf.</span>
<span class="go">You can view and customise the corresponding TeX file at tutorial_1d.tex.</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/a702e74ed1e8f1add5261920e35e41f0/tutorial_1d.txt"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d.txt</span></code></a>: Text file.</p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/28fb41a422ee8f7f45686e5b9f7b9f6b/tutorial_1d.pdf"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d.pdf</span></code></a>: PDF file.</p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/2279f0a8714ca81ac1f5156848131e06/tutorial_1d.tex"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d.tex</span></code></a>: TeX file used to generate the PDF</p></li>
</ul>
</section>
<section id="creating-result-plots">
<h3>Creating result plots<a class="headerlink" href="#creating-result-plots" title="Link to this heading">¶</a></h3>
<p>Figures giving an overview of the estimation result can be generated using
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.plot_result" title="nmrespy.Estimator1D.plot_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_result()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;index_1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
<span class="gp">... </span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">plot_result</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">3.</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">region_unit</span><span class="o">=</span><span class="s2">&quot;ppm&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">axes_left</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">axes_right</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">axes_top</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">axes_bottom</span><span class="o">=</span><span class="mf">0.09</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tutorial_1d_</span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2">_fig.pdf&quot;</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/ab73b1077f2165430aa6b1323c318527/tutorial_1d_complete_fig.pdf"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d_complete_fig.pdf</span></code></a>:
result for all regions considered</p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/5248901b7405bc1aea8864ccb68486e3/tutorial_1d_index_1_fig.pdf"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d_index_1_fig.pdf</span></code></a>: result for 2nd estimated
region only (index 1)</p></li>
</ul>
</section>
<section id="saving-the-estimator">
<h3>Saving the estimator<a class="headerlink" href="#saving-the-estimator" title="Link to this heading">¶</a></h3>
<p>The estimator object itself can be saved and reloaded for future use with the
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.to_pickle" title="nmrespy.Estimator1D.to_pickle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_pickle()</span></code></a> and
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.from_pickle" title="nmrespy.Estimator1D.from_pickle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_pickle()</span></code></a> methods, respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;tutorial_1d&quot;</span><span class="p">)</span>
<span class="go">Saved file tutorial_1d.pkl.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load the estimator and assign to the `estimator_cp` variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator_cp</span> <span class="o">=</span> <span class="n">ne</span><span class="o">.</span><span class="n">Estimator1D</span><span class="o">.</span><span class="n">from_pickle</span><span class="p">(</span><span class="s2">&quot;tutorial_1d&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/c5b11b59a56bad04a6ef9b05dba3ae83/tutorial_1d.pkl"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d.pkl</span></code></a></p></li>
</ul>
</section>
<section id="saving-a-logfile">
<h3>Saving a logfile<a class="headerlink" href="#saving-a-logfile" title="Link to this heading">¶</a></h3>
<p>A logfile listing all the methods called on the estimator can be created using
<a class="reference internal" href="../references/estimator1d.html#nmrespy.Estimator1D.save_log" title="nmrespy.Estimator1D.save_log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_log()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">save_log</span><span class="p">(</span><span class="s2">&quot;tutorial_1d&quot;</span><span class="p">)</span>
<span class="go">Saved file tutorial_1d.log.</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/bc327f06eee1102ac65b3c95595a1c0f/tutorial_1d.log"><code class="xref download docutils literal notranslate"><span class="pre">tutorial_1d.log</span></code></a></p></li>
</ul>
</section>
<section id="the-full-script">
<h3>The full script<a class="headerlink" href="#the-full-script" title="Link to this heading">¶</a></h3>
<p>Everything covered here is incorporated into the following Python script:
<a class="reference download internal" download="" href="../_downloads/37f7559ae34e00eca327de20f1739d76/estimator1d_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">estimator1d_tutorial.py</span></code></a></p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><style>
.aligncenter {
    text-align: center;
}
</style>

<a href="https://foroozandehgroup.github.io/NMR-EsPy/">
    <img style="padding: 0px 0px 12px"
         src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/nmrespy_full.png"
         alt="NMR-EsPy logo"
         width=230px
         height=auto />
</a>

<p class="aligncenter">
    <a href="https://github.com/foroozandehgroup/NMR-EsPy">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/github.png"
             alt="Github"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

    <a href="mailto:simonhulse@protonmail.com?subject=NMR-EsPy%20query">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/email_icon.png"
             alt="email"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

<!--     <a href="https://foroozandeh.chem.ox.ac.uk/home"> -->
<!--         <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/develop/nmrespy/images/link.png" -->
<!--              alt="Group website" -->
<!--              width=auto -->
<!--              height=30px /> -->
<!--     </a> -->
</p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Using <code class="docutils literal notranslate"><span class="pre">Estimator1D</span></code></a><ul>
<li><a class="reference internal" href="#generating-an-instance">Generating an instance</a><ul>
<li><a class="reference internal" href="#bruker-data">Bruker data</a></li>
<li><a class="reference internal" href="#simulated-data-from-a-set-of-signal-parameters">Simulated data from a set of signal parameters</a></li>
<li><a class="reference internal" href="#simulated-data-from-spinach">Simulated data from Spinach</a></li>
</ul>
</li>
<li><a class="reference internal" href="#viewing-and-accessing-the-dataset">Viewing and accessing the dataset</a></li>
<li><a class="reference internal" href="#estimating-the-dataset">Estimating the dataset</a></li>
<li><a class="reference internal" href="#inspecting-estimation-results">Inspecting estimation results</a><ul>
<li><a class="reference internal" href="#writing-result-tables">Writing result tables</a></li>
<li><a class="reference internal" href="#creating-result-plots">Creating result plots</a></li>
<li><a class="reference internal" href="#saving-the-estimator">Saving the estimator</a></li>
<li><a class="reference internal" href="#saving-a-logfile">Saving a logfile</a></li>
<li><a class="reference internal" href="#the-full-script">The full script</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div><h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation index</a><ul>
  <li><a href="index.html">Tutorials</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Tutorials</a></li>
      <li>Next: <a href="estimator2dj.html" title="next chapter">Using <code class="docutils literal notranslate"><span class="pre">Estimator2DJ</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/walkthroughs/estimator1d.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
  </body>
</html>