

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>nmrespy.mpm &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="nmrespy.nlp" href="nlp/index.html" />
    <link rel="prev" title="nmrespy.freqfilter" href="freqfilter.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nlp/index.html" title="nmrespy.nlp"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="freqfilter.html" title="nmrespy.freqfilter"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.mpm</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="module-nmrespy.mpm">
<span id="nmrespy-mpm"></span><h1>nmrespy.mpm<a class="headerlink" href="#module-nmrespy.mpm" title="Permalink to this headline">¶</a></h1>
<p>Computation of signal estimates using the Matrix Pencil Method.</p>
<dl class="py class">
<dt class="sig sig-object py" id="nmrespy.mpm.MatrixPencil">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">nmrespy.mpm.</span></span><span class="sig-name descname"><span class="pre">MatrixPencil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nmrespy/mpm.html#MatrixPencil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.mpm.MatrixPencil" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for performing the Matrix Pencil Method with the option of model
order selection using the Minimum Description Length (MDL) <a class="footnote-reference brackets" href="#id6" id="id1">1</a>. Supports
analysis of one-dimensional <a class="footnote-reference brackets" href="#id7" id="id2">2</a> <a class="footnote-reference brackets" href="#id8" id="id3">3</a> or two-dimensional data <a class="footnote-reference brackets" href="#id9" id="id4">4</a> <a class="footnote-reference brackets" href="#id10" id="id5">5</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – Signal to be considered (unnormalised).</p></li>
<li><p><strong>sw</strong> (<em>[</em><em>float</em><em>] or </em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The experiment sweep width in each dimension in Hz.</p></li>
<li><p><strong>offset</strong> (<em>[</em><em>float</em><em>]</em><em>, </em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>None</em><em>, </em><em>default: None</em>) – The experiment transmitter offset frequency in Hz.</p></li>
<li><p><strong>sfo</strong> (<em>[</em><em>float</em><em>]</em><em>, </em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>None</em><em>, </em><em>default: None</em>) – The experiment transmitter frequency in each dimension in MHz. This is
not necessary, however if it set it <cite>None</cite>, no conversion from Hz
to ppm will be possible!</p></li>
<li><p><strong>M</strong> (<em>int</em><em>, </em><em>default: 0</em>) – The number of oscillators. If <cite>0</cite>, the number of oscilators will
be estimated using the MDL.</p></li>
<li><p><strong>fprint</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Flag specifiying whether to print infomation to the terminal as
the method runs.</p></li>
<li><p><strong>start_point</strong> (<em>int</em><em>, </em><em>default: 0</em>) – The first timepoint sampled, in units of
<img class="math" src="../_images/math/73c0292a780912fed0f96bc618a2680f51829349.png" alt="\Delta t = 1 / f_{\mathrm{sw}}"/></p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>M. Wax, T. Kailath, Detection of signals by information theoretic
criteria, IEEE Transactions on Acoustics, Speech, and Signal Processing
33 (2) (1985) 387–392.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Yingbo Hua and Tapan K Sarkar. “Matrix pencil method for estimating
parameters of exponentially damped/undamped sinusoids in noise”. In:
IEEE Trans. Acoust., Speech, Signal Process. 38.5 (1990), pp. 814–824.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Yung-Ya Lin et al. “A novel detection–estimation scheme for noisy
NMR signals: applications to delayed acquisition data”. In: J. Magn.
Reson. 128.1 (1997), pp. 30–41.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Yingbo Hua. “Estimating two-dimensional frequencies by matrix
enhancement and matrix pencil”. In: [Proceedings] ICASSP 91: 1991
International Conference on Acoustics, Speech, and Signal Processing.
IEEE. 1991, pp. 3073–3076.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>Fang-Jiong Chen et al. “Estimation of two-dimensional frequencies
using modified matrix pencil method”. In: IEEE Trans. Signal Process.
55.2 (2007), pp. 718–724.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.mpm.MatrixPencil.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nmrespy/mpm.html#MatrixPencil.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.mpm.MatrixPencil.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks validity of inputs, and if valid, calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">_mpm()</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.mpm.MatrixPencil._mpm_1d">
<span class="sig-name descname"><span class="pre">_mpm_1d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nmrespy/mpm.html#MatrixPencil._mpm_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.mpm.MatrixPencil._mpm_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs 1-dimensional Matrix Pencil Method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.mpm.MatrixPencil._mpm_2d">
<span class="sig-name descname"><span class="pre">_mpm_2d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nmrespy/mpm.html#MatrixPencil._mpm_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.mpm.MatrixPencil._mpm_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs 2-dimensional Modified Matrix Enhanced Pencil Method.</p>
<div class="admonition-todo admonition" id="id11">
<p class="admonition-title">Todo</p>
<p>To be written</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.mpm.MatrixPencil.get_result">
<span class="sig-name descname"><span class="pre">get_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nmrespy/mpm.html#MatrixPencil.get_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.mpm.MatrixPencil.get_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the result of the MPM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>freq_unit</strong> (<em>'hz'</em><em> or </em><em>'ppm'</em><em>, </em><em>default: 'hz'</em>) – The unit of the oscillator frequencies (corresponding to
<code class="docutils literal notranslate"><span class="pre">result[:,</span> <span class="pre">2]</span></code>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="freqfilter.html"
                        title="previous chapter">nmrespy.freqfilter</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nlp/index.html"
                        title="next chapter">nmrespy.nlp</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/references/mpm.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nlp/index.html" title="nmrespy.nlp"
             >next</a> |</li>
        <li class="right" >
          <a href="freqfilter.html" title="nmrespy.freqfilter"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.mpm</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Simon Hulse &amp; Mohammadali Foroozandeh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>