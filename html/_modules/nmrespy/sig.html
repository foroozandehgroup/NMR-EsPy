

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>nmrespy.sig &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.sig</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for nmrespy.sig</h1><div class="highlight"><pre>
<span></span><span class="c1"># sig.py</span>
<span class="c1"># Simon Hulse</span>
<span class="c1"># simon.hulse@chem.ox.ac.uk</span>

<span class="sd">&quot;&quot;&quot;Constructing and processing NMR signals&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftshift</span><span class="p">,</span> <span class="n">ifft</span><span class="p">,</span> <span class="n">ifftshift</span>
<span class="kn">import</span> <span class="nn">numpy.random</span> <span class="k">as</span> <span class="nn">nrandom</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">integrate</span>

<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FigureCanvasTkAgg</span><span class="p">,</span> <span class="n">NavigationToolbar2Tk</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">nmrespy._cols</span> <span class="k">as</span> <span class="nn">cols</span>
<span class="k">if</span> <span class="n">cols</span><span class="o">.</span><span class="n">USE_COLORAMA</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">colorama</span>
    <span class="n">colorama</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">nmrespy._errors</span> <span class="k">as</span> <span class="nn">errors</span>
<span class="kn">from</span> <span class="nn">nmrespy._misc</span> <span class="kn">import</span> <span class="n">ArgumentChecker</span>

<span class="sd">&quot;&quot;&quot;Provides functionality for constructing synthetic FIDs&quot;&quot;&quot;</span>


<div class="viewcode-block" id="make_fid"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.make_fid">[docs]</a><span class="k">def</span> <span class="nf">make_fid</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decibels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">modulation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Constructs a discrete time-domain signal (FID), as a summation of</span>
<span class="sd">    exponentially damped complex sinusoids.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : numpy.ndarray</span>
<span class="sd">        Parameter array with the following structure:</span>

<span class="sd">        * **1-dimensional data:**</span>

<span class="sd">          .. code:: python</span>

<span class="sd">             parameters = numpy.array([</span>
<span class="sd">                [a_1, φ_1, f_1, η_1],</span>
<span class="sd">                [a_2, φ_2, f_2, η_2],</span>
<span class="sd">                ...,</span>
<span class="sd">                [a_m, φ_m, f_m, η_m],</span>
<span class="sd">             ])</span>

<span class="sd">        * **2-dimensional data:**</span>

<span class="sd">          .. code:: python</span>

<span class="sd">             parameters = numpy.array([</span>
<span class="sd">                [a_1, φ_1, f1_1, f2_1, η1_1, η2_1],</span>
<span class="sd">                [a_2, φ_2, f1_2, f2_2, η1_2, η2_2],</span>
<span class="sd">                ...,</span>
<span class="sd">                [a_m, φ_m, f1_m, f2_m, η1_m, η2_m],</span>
<span class="sd">             ])</span>

<span class="sd">    n : [int], [int, int]</span>
<span class="sd">        Number of points to construct signal from in each dimension.</span>

<span class="sd">    sw : [float], [float, float]</span>
<span class="sd">        Sweep width in each dimension, in Hz.</span>

<span class="sd">    offset : [float], [float, float], or None, default: None</span>
<span class="sd">        Transmitter offset frequency in each dimension, in Hz. If set to</span>
<span class="sd">        `None`, the offset frequency will be set to 0Hz in each dimension.</span>

<span class="sd">    snr : float or None, default: None</span>
<span class="sd">        The signal-to-noise ratio. If `None` then no noise will be added</span>
<span class="sd">        to the FID.</span>

<span class="sd">    decibels : bool, default: True</span>
<span class="sd">        If `True`, the snr is taken to be in units of decibels. If `False`,</span>
<span class="sd">        it is taken to be simply the ratio of the singal power over the</span>
<span class="sd">        noise power.</span>

<span class="sd">    modulation : {&#39;none&#39;, &#39;amp&#39;, &#39;phase&#39;}, default: &#39;none&#39;</span>
<span class="sd">        The type of modulation present in the indirect dimension, if the data</span>
<span class="sd">        is 2D. `In the expressions below, a it is assumed a single oscillator</span>
<span class="sd">        has been provided for simplicity`.</span>

<span class="sd">        * `&#39;none&#39;`: Returns a single signal of the form:</span>

<span class="sd">          .. math::</span>

<span class="sd">             y(t_1, t_2) = a \\exp(\\mathrm{i} \\phi)</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_1 - \\eta_1 \\right)</span>
<span class="sd">             t_1 \\right]</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_2 - \\eta_2 \\right)</span>
<span class="sd">             t_2 \\right]</span>

<span class="sd">        * `&#39;amp&#39;`: Returns an amplitude-modulated pair of signals of the form:</span>

<span class="sd">          .. math::</span>

<span class="sd">             y_{\\mathrm{cos}}(t_1, t_2) = a \\exp(\\mathrm{i} \\phi)</span>
<span class="sd">             \\cos \\left( 2 \\pi f_1 t_1 \\right)</span>
<span class="sd">             \\exp \\left( - \\eta_1 t_1 \\right)</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_2 - \\eta_2 \\right)</span>
<span class="sd">             t_2 \\right]</span>

<span class="sd">             y_{\\mathrm{sin}}(t_1, t_2) = a \\exp(\\mathrm{i} \\phi)</span>
<span class="sd">             \\sin \\left( 2 \\pi f_1 t_1 \\right)</span>
<span class="sd">             \\exp \\left( - \\eta_1 t_1 \\right)</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_2 - \\eta_2 \\right)</span>
<span class="sd">             t_2 \\right]</span>

<span class="sd">        * `&#39;phase&#39;`: Returns an phase-modulated pair of signals of the form:</span>

<span class="sd">          .. math::</span>

<span class="sd">             y_{\\mathrm{P}}(t_1, t_2) = a \\exp(\\mathrm{i} \\phi)</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_1 - \\eta_1 \\right)</span>
<span class="sd">             t_1 \\right]</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_2 - \\eta_2 \\right)</span>
<span class="sd">             t_2 \\right]</span>

<span class="sd">             y_{\\mathrm{N}}(t_1, t_2) = a \\exp(\\mathrm{i} \\phi)</span>
<span class="sd">             \\exp \\left[ \\left( - 2 \\pi \\mathrm{i} f_1 - \\eta_1 \\right)</span>
<span class="sd">             t_1 \\right]</span>
<span class="sd">             \\exp \\left[ \\left( 2 \\pi \\mathrm{i} f_2 - \\eta_2 \\right)</span>
<span class="sd">             t_2 \\right]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fid : numpy.ndarray, [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The synthetic signal generated.</span>

<span class="sd">        + If the data to be constructed is 1D or 2D with `modulation` set to</span>
<span class="sd">          `&#39;none&#39;`, the result will be a NumPy array.</span>
<span class="sd">        + If the data is 2D with `modulation` set to `&#39;amp&#39;`, or `&#39;phase&#39;`</span>
<span class="sd">          the result will be a length-2 list with signals of the forms</span>
<span class="sd">          indicated above (See `modulation`).</span>

<span class="sd">    tp : [numpy.ndarray], [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The time points the FID is sampled at in each dimension.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The resulting `fid` is given by</span>

<span class="sd">    .. math::</span>

<span class="sd">       y[n_1, \\cdots, n_D] =</span>
<span class="sd">       \\sum_{m=1}^{M} a_m \\exp\\left(\\mathrm{i} \\phi_m\\right)</span>
<span class="sd">       \\prod_{d=1}^{D}</span>
<span class="sd">       \\exp\\left[\\left(2 \\pi \\mathrm{i} f_m - \\eta_m\\right)</span>
<span class="sd">       n_d \\Delta t_d\\right]</span>

<span class="sd">    where :math:`d` is either 1 or 2, :math:`M` is the number of</span>
<span class="sd">    oscillators, and :math:`\\Delta t_d = 1 / f_{\\mathrm{sw}, d}`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># --- Check validity of inputs ---------------------------------------</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">n should be iterable.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;parameter&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;int_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">decibels</span><span class="p">,</span> <span class="s1">&#39;decibels&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">modulation</span><span class="p">,</span> <span class="s1">&#39;modulation&#39;</span><span class="p">,</span> <span class="s1">&#39;modulation&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">snr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">snr</span><span class="p">,</span> <span class="s1">&#39;snr&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">))</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>

    <span class="c1"># --- Extract amplitudes, phases, frequencies and damping ------------</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Center frequencies at 0 based on offset</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameters</span><span class="p">[:,</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
    <span class="n">damp</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameters</span><span class="p">[:,</span> <span class="n">dim</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>

    <span class="c1"># Time points in each dimension</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="n">get_timepoints</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">)</span>

    <span class="c1"># --- Generate noiseless FID -----------------------------------------</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Vandermonde matrix of poles</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">damp</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="c1"># Vector of complex ampltiudes</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="c1"># Compute FID!</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">@</span> <span class="n">alpha</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">modulation</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;amp&#39;</span><span class="p">]:</span>
            <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">damp</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="k">if</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;amp&#39;</span><span class="p">:</span>
                <span class="n">Z1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Z1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Z1</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;phase&#39;</span><span class="p">:</span>
            <span class="n">Z1</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">damp</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">tp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">damp</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="p">]</span>

        <span class="n">Z2t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">((</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">damp</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tp</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="c1"># Diagonal matrix of complex amplitudes</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">))</span>

        <span class="n">fid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">z1</span> <span class="ow">in</span> <span class="n">Z1</span><span class="p">:</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1</span> <span class="o">@</span> <span class="n">A</span> <span class="o">@</span> <span class="n">Z2t</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="n">fid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># --- Add noise to FID -----------------------------------------------</span>
    <span class="k">if</span> <span class="n">snr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fid</span><span class="p">,</span> <span class="n">tp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">fid</span> <span class="o">+</span> <span class="n">make_noise</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span> <span class="n">decibels</span><span class="p">),</span> <span class="n">tp</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fid</span><span class="p">):</span>
                <span class="n">fid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">make_noise</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span> <span class="n">decibels</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fid</span><span class="p">,</span> <span class="n">tp</span></div>


<div class="viewcode-block" id="make_virtual_echo"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.make_virtual_echo">[docs]</a><span class="k">def</span> <span class="nf">make_virtual_echo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">modulation</span><span class="o">=</span><span class="s1">&#39;amp&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given the time-domain signal `data`, generates the corresponding</span>
<span class="sd">    virtual echo [#]_, a signal with a purely real Fourier-Tranform and</span>
<span class="sd">    absorption mode line shape if the data is phased.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : [numpy.ndarray] or [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The data to construct the virtual echo from. This should be a list of</span>
<span class="sd">        NumPy arrays, with ``len(data) == d`` where ``d`` is the dimension</span>
<span class="sd">        of the signal.</span>

<span class="sd">    modulation : {&#39;amp&#39; or &#39;phase&#39;}, default: &#39;amp&#39;</span>
<span class="sd">        If the data is 2D, this parameter specifies the type of modulation</span>
<span class="sd">        present in the indirect dimension of the dataset.</span>

<span class="sd">        * If set to `&#39;amp&#39;`, the two signals in the `data` should be an</span>
<span class="sd">          amplitude modulated pair.</span>
<span class="sd">        * If set to `&#39;phase&#39;`, the two signals in the `data` should be a phase</span>
<span class="sd">          modulated pair.</span>

<span class="sd">        See the docs for :py:func:`make_fid` for more info on `modulation`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    virtual_echo : numpy.ndarray</span>
<span class="sd">        The virtual echo signal assocaited with `data`.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [#] M. Mayzel, K. Kazimierczuk, V. Y. Orekhov, The causality principle</span>
<span class="sd">           in the reconstruction of sparse nmr spectra, Chem. Commun. 50 (64)</span>
<span class="sd">           (2014) 8947–8950.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">n should be iterable.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">MoreThanTwoDimError</span><span class="p">()</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span>
        <span class="p">[(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;array_list&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="n">modulation</span><span class="p">,</span> <span class="s1">&#39;modulation&#39;</span><span class="p">,</span> <span class="s1">&#39;modulation&#39;</span><span class="p">)],</span>
        <span class="n">dim</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
        <span class="n">ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        <span class="n">ve</span><span class="p">[:</span><span class="n">pts</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">ve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ve</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ve</span><span class="p">[</span><span class="n">pts</span><span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">conj</span><span class="p">()[</span><span class="mi">1</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ve</span>

    <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># TODO NEEDS FIXING</span>
        <span class="k">if</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;amp&#39;</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Phase modulated (P and N) signals</span>
            <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># S±± = (R₁ ± iI₁)(R₂ ± iI₂)</span>
        <span class="c1"># where: Re(c) -&gt; R₁R₂, Im(c) -&gt; R₁I₂, Re(s) -&gt; I₁R₂, Im(s) -&gt; I₁I₂</span>
        <span class="n">r1r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">r1i2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">i1r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">i1i2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="c1"># S++ = R₁R₂ - I₁I₂ + i(R₁I₂ + I₁R₂)</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">i1i2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1i2</span> <span class="o">+</span> <span class="n">i1r2</span><span class="p">)</span>
        <span class="c1"># S+- = R₁R₂ + I₁I₂ + i(I₁R₂ - R₁I₂)</span>
        <span class="n">pm</span> <span class="o">=</span> <span class="n">r1r2</span> <span class="o">+</span> <span class="n">i1i2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">i1r2</span> <span class="o">-</span> <span class="n">r1i2</span><span class="p">)</span>
        <span class="c1"># S-+ = R₁R₂ + I₁I₂ + i(R₁I₂ - I₁R₂)</span>
        <span class="n">mp</span> <span class="o">=</span> <span class="n">r1r2</span> <span class="o">+</span> <span class="n">i1i2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1i2</span> <span class="o">-</span> <span class="n">i1r2</span><span class="p">)</span>
        <span class="c1"># S-- = R₁R₂ - I₁I₂ - i(R₁I₂ + I₁R₂)</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">i1i2</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1i2</span> <span class="o">+</span> <span class="n">i1r2</span><span class="p">)</span>

        <span class="n">pts</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">tmp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        <span class="n">tmp1</span><span class="p">[:</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pp</span>
        <span class="n">tmp1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>

        <span class="n">tmp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        <span class="n">tmp2</span><span class="p">[:</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">pm</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tmp2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp2</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tmp2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">tmp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        <span class="n">tmp3</span><span class="p">[</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tmp3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tmp3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">tmp4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
        <span class="n">tmp4</span><span class="p">[</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:,</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">mm</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tmp4</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp4</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>
        <span class="n">tmp4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">tmp4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">tmp1</span> <span class="o">+</span> <span class="n">tmp2</span> <span class="o">+</span> <span class="n">tmp3</span> <span class="o">+</span> <span class="n">tmp4</span></div>


<div class="viewcode-block" id="get_timepoints"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.get_timepoints">[docs]</a><span class="k">def</span> <span class="nf">get_timepoints</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates the timepoints at which an FID is sampled at, given</span>
<span class="sd">    its sweep-width, and the number of points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : [int] or [int, int]</span>
<span class="sd">        The number of points in each dimension.</span>

<span class="sd">    sw : [float] or [float, float]</span>
<span class="sd">        THe sweep width in each dimension (Hz).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tp : [numpy.ndarray] or [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The time points sampled in each dimension</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">n should be iterable.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ArgumentChecker</span><span class="p">([(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;int_list&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">)],</span> <span class="n">dim</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">sw_</span><span class="p">,</span> <span class="n">n_</span><span class="p">)</span> <span class="k">for</span> <span class="n">n_</span><span class="p">,</span> <span class="n">sw_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">)]</span></div>


<div class="viewcode-block" id="get_shifts"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.get_shifts">[docs]</a><span class="k">def</span> <span class="nf">get_shifts</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates the frequencies that the FT of the FID is sampled at, given</span>
<span class="sd">    its sweep-width, the transmitter offset, and the number of points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : [int] or [int, int]</span>
<span class="sd">        The number of points in each dimension.</span>

<span class="sd">    sw : [float] or [float, float]</span>
<span class="sd">        The sweep width in each dimension.</span>

<span class="sd">    offset : [float], [float, float], or None, default: None</span>
<span class="sd">        The transmitter offset in each dimension. If `None`, the</span>
<span class="sd">        offset will be set to zero in each dimension.</span>

<span class="sd">    flip : bool, default: True</span>
<span class="sd">        If `True`, the shifts will be returned in descending order, as is</span>
<span class="sd">        conventional in NMR. If `False`, the shifts will be in ascending order.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    shifts : [numpy.ndarray] or [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The chemical shift values sampled in each dimension.&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">n should be iterable.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;int_list&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="n">dim</span><span class="o">=</span><span class="n">dim</span>
    <span class="p">)</span>

    <span class="n">shifts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n_</span><span class="p">,</span> <span class="n">sw_</span><span class="p">,</span> <span class="n">off</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="n">shifts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">((</span><span class="o">-</span><span class="n">sw_</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">off</span><span class="p">,</span> <span class="p">(</span><span class="n">sw_</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">off</span><span class="p">,</span> <span class="n">n_</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">shifts</span><span class="p">)</span> <span class="k">if</span> <span class="n">flip</span> <span class="k">else</span> <span class="n">shifts</span></div>


<div class="viewcode-block" id="ft"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.ft">[docs]</a><span class="k">def</span> <span class="nf">ft</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs Fourier transformation and (optionally) flips the resulting</span>
<span class="sd">    spectrum to satisfy NMR convention.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fid : numpy.ndarray</span>
<span class="sd">        Time-domain data.</span>

<span class="sd">    flip : bool, default: True</span>
<span class="sd">        Whether or not to flip the Fourier Trnasform of `fid` in each</span>
<span class="sd">        dimension.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spectrum : numpy.ndarray</span>
<span class="sd">        Fourier transform of the data, flipped in each dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ArgumentChecker</span><span class="p">([(</span><span class="n">fid</span><span class="p">,</span> <span class="s1">&#39;fid&#39;</span><span class="p">,</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="s1">&#39;flip&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">)])</span>

    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fid</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">fftshift</span><span class="p">(</span><span class="n">spectrum</span><span class="p">))</span> <span class="k">if</span> <span class="n">flip</span> <span class="k">else</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span></div>


<div class="viewcode-block" id="proc_amp_modulated"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.proc_amp_modulated">[docs]</a><span class="k">def</span> <span class="nf">proc_amp_modulated</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes a pair of 2D amplitude-modulated signals, and generates the</span>
<span class="sd">    frequency-discriminated spectrum.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        cos-modulated signal and sin-modulated signal</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spectrum : dict</span>
<span class="sd">        Dictionary of four elements: ``rr``, ``ri``, ``ir``, and ``ii``.&quot;&quot;&quot;</span>

    <span class="n">ArgumentChecker</span><span class="p">([(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;array_list&#39;</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">c_t1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s_t1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fftshift</span><span class="p">(</span>
        <span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">c_t1_f2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">s_t1_f2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="proc_phase_modulated"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.proc_phase_modulated">[docs]</a><span class="k">def</span> <span class="nf">proc_phase_modulated</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes a pair of 2D phase-modulated signals, and generates the</span>
<span class="sd">    set of spectra corresponding to the processing protocol outlined in [#]_.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        P-type signal and N-type signal</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spectra : dict</span>
<span class="sd">        Dictionary of four elements: ``rr``, ``ri``, ``ir``, and ``ii``.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [#] A. L. Davis, J. Keeler, E. D. Laue, and D. Moskau, “Experiments for</span>
<span class="sd">           recording pure-absorption heteronuclear correlation spectra using</span>
<span class="sd">           pulsed field gradients,” Journal of Magnetic Resonance (1969),</span>
<span class="sd">           vol. 98, no. 1, pp. 207–216, 1992.&quot;&quot;&quot;</span>

    <span class="n">ArgumentChecker</span><span class="p">([(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;array_list&#39;</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">p_t1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sₚ(t₁,f₂)</span>
    <span class="n">n_t1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sₙ(t₁,f₂)</span>

    <span class="c1"># Generating rr and ir</span>
    <span class="n">plus_t1_f2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_t1_f2</span> <span class="o">+</span> <span class="n">n_t1_f2</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>           <span class="c1"># S⁺(t₁,f₂)</span>
    <span class="n">plus_f1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">plus_t1_f2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># S⁺(f₁,f₂)</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">plus_f1_f2</span><span class="p">)</span>  <span class="c1"># A₁A₂</span>
    <span class="n">ir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">plus_f1_f2</span><span class="p">)</span>  <span class="c1"># D₁A₂</span>

    <span class="c1"># Generating ri and ii</span>
    <span class="n">minus_t1_f2</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_t1_f2</span> <span class="o">-</span> <span class="n">n_t1_f2</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>     <span class="c1"># S⁻(t₁,f₂)</span>
    <span class="n">minus_f1_f2</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">minus_t1_f2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># S⁻(f₁,f₂)</span>
    <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">minus_f1_f2</span><span class="p">)</span>  <span class="c1"># A₁D₂</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">minus_f1_f2</span><span class="p">)</span>  <span class="c1"># D₁D₂</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;rr&#39;</span><span class="p">:</span> <span class="n">rr</span><span class="p">,</span>
        <span class="s1">&#39;ri&#39;</span><span class="p">:</span> <span class="n">ri</span><span class="p">,</span>
        <span class="s1">&#39;ir&#39;</span><span class="p">:</span> <span class="n">ir</span><span class="p">,</span>
        <span class="s1">&#39;ii&#39;</span><span class="p">:</span> <span class="n">ii</span><span class="p">,</span>
    <span class="p">}</span></div>


<div class="viewcode-block" id="ift"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.ift">[docs]</a><span class="k">def</span> <span class="nf">ift</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flips spectral data in each dimension, and then inverse Fourier</span>
<span class="sd">    transforms.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spectrum : numpy.ndarray</span>
<span class="sd">        Spectrum</span>

<span class="sd">    flip : bool, default: True</span>
<span class="sd">        Whether or not to flip `spectrum` in each dimension prior to Inverse</span>
<span class="sd">        Fourier Transform.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fid : numpy.ndarray</span>
<span class="sd">        Inverse Fourier transform of the spectrum.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="s1">&#39;flip&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">spectrum</span><span class="p">))</span> <span class="k">if</span> <span class="n">flip</span> <span class="k">else</span> <span class="n">ifftshift</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>

    <span class="n">fid</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">fid</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fid</span></div>


<div class="viewcode-block" id="phase"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.phase">[docs]</a><span class="k">def</span> <span class="nf">phase</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Applies a linear phase correction to `data`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : numpy.ndarray</span>
<span class="sd">        Data to be phased.</span>

<span class="sd">    p0 : [float] or [float, float]</span>
<span class="sd">        Zero-order phase correction in each dimension, in radians.</span>

<span class="sd">    p1 : [float] or [float, float]</span>
<span class="sd">        First-order phase correction in each dimension, in radians.</span>

<span class="sd">    pivot : [int], [int, int] or None</span>
<span class="sd">        Index of the pivot in each dimension. If None, the pivot will be `0`</span>
<span class="sd">        in each dimension.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    phased_data : numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">p0 should be iterable.</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pivot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="s1">&#39;pivot&#39;</span><span class="p">,</span> <span class="s1">&#39;int_list&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>

    <span class="c1"># Indices for einsum</span>
    <span class="c1"># For 1D: &#39;i&#39;</span>
    <span class="c1"># For 2D: &#39;ij&#39;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">105</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="p">(</span><span class="n">piv</span><span class="p">,</span> <span class="n">p0_</span><span class="p">,</span> <span class="n">p1_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">)):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="c1"># Determine axis for einsum (i or j)</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">axis</span> <span class="o">+</span> <span class="mi">105</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">p0_</span> <span class="o">+</span> <span class="n">p1_</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">piv</span><span class="p">,</span> <span class="o">-</span><span class="n">piv</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">phased_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s1">-&gt;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">phased_data</span></div>


<div class="viewcode-block" id="manual_phase_spectrum"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.manual_phase_spectrum">[docs]</a><span class="k">def</span> <span class="nf">manual_phase_spectrum</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">max_p1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a GUI, enabling manual phase correction, with the zero- and</span>
<span class="sd">    first-order phases returned.</span>

<span class="sd">    .. warning::</span>
<span class="sd">       Only 1D spectral data is currently supported.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spectrum : numpy.ndarray</span>
<span class="sd">        Spectral data of interest.</span>

<span class="sd">    max_p1 : float or None, default: None</span>
<span class="sd">        Specifies the range of first-order phases permitted. For each</span>
<span class="sd">        dimension, the user will be allowed to choose a value of `p1`</span>
<span class="sd">        within [`-max_p1`, `max_p1`]. By default, `max_p1` will be</span>
<span class="sd">        ``10 * numpy.pi``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    p0 : [float] or None</span>
<span class="sd">        Zero-order phase correction in each dimension, in radians. If the</span>
<span class="sd">        user chooses to cancel rather than save, this is set to `None`.</span>

<span class="sd">    p1 : [float] or None</span>
<span class="sd">        First-order phase correction in each dimension, in radians. If the</span>
<span class="sd">        user chooses to cancel rather than save, this is set to `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">soectrum should be a numpy array</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Only valid for 1D so far</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">TwoDimUnsupportedError</span><span class="p">()</span>

    <span class="n">init_spectrum</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max_p1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_p1</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">PhaseApp</span><span class="p">(</span><span class="n">init_spectrum</span><span class="p">,</span> <span class="n">max_p1</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">app</span><span class="o">.</span><span class="n">p0</span><span class="p">,</span> <span class="n">app</span><span class="o">.</span><span class="n">p1</span></div>


<div class="viewcode-block" id="PhaseApp"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.PhaseApp">[docs]</a><span class="k">class</span> <span class="nc">PhaseApp</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tkinter application for manual phase correction.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :py:func:`manual_phase_spectrum`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">,</span> <span class="n">max_p1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pivot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_spectrum</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">160</span><span class="p">)</span>
        <span class="c1"># Set colour of figure frame</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cget</span><span class="p">(</span><span class="s1">&#39;bg&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">0.87</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">spectrum</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

        <span class="n">mx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">spectrum</span><span class="p">))),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pivotline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">mx</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">mx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pack_toolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;pivot&#39;</span><span class="p">,</span> <span class="s1">&#39;p0&#39;</span><span class="p">,</span> <span class="s1">&#39;p1&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="n">max_p1</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">max_p1</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">init</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">items</span><span class="p">)):</span>
            <span class="n">lab</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="n">pady</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">lab</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">pady</span><span class="o">=</span><span class="n">pady</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="p">,</span>
                <span class="n">from_</span><span class="o">=</span><span class="n">mn</span><span class="p">,</span>
                <span class="n">to</span><span class="o">=</span><span class="n">mx</span><span class="p">,</span>
                <span class="n">resolution</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span>
                <span class="n">showvalue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">sliderlength</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                <span class="n">bd</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">highlightthickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                <span class="n">relief</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span>
                <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_phase</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">scale</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
            <span class="n">scale</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="n">pady</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_frame</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
                     <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="n">pady</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save&#39;</span><span class="p">,</span>
            <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;#77dd77&#39;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_frame</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">highlightbackground</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span>
            <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;#ff5566&#39;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">update_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_scale&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;pivot&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pivot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pivot_label</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pivotline</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_label&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">phase</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_spectrum</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p0</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p1</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specline</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">spectrum</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pivot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="make_noise"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.make_noise">[docs]</a><span class="k">def</span> <span class="nf">make_noise</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span> <span class="n">decibels</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given a synthetic FID, generate an array of normally distributed</span>
<span class="sd">    complex noise with zero mean and a variance that abides by the desired</span>
<span class="sd">    SNR.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fid : numpy.ndarray</span>
<span class="sd">        Noiseless FID.</span>

<span class="sd">    snr : float</span>
<span class="sd">        The signal-to-noise ratio.</span>

<span class="sd">    decibels : bool, default: True</span>
<span class="sd">        If `True`, the snr is taken to be in units of decibels. If `False`,</span>
<span class="sd">        it is taken to be simply the ratio of the singal power and noise</span>
<span class="sd">        power.</span>

<span class="sd">    Returns</span>
<span class="sd">    _______</span>
<span class="sd">    noise : numpy.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="s1">&#39;fid&#39;</span><span class="p">,</span> <span class="s1">&#39;ndarray&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">snr</span><span class="p">,</span> <span class="s1">&#39;snr&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">decibels</span><span class="p">,</span> <span class="s1">&#39;decibels&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">fid</span><span class="o">.</span><span class="n">size</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">fid</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Compute the variance of the noise</span>
    <span class="k">if</span> <span class="n">decibels</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="p">(</span><span class="mi">20</span> <span class="o">**</span> <span class="p">(</span><span class="n">snr</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">size</span> <span class="o">*</span> <span class="n">snr</span><span class="p">))</span>

    <span class="c1"># Make a number of noise instances and check which two are closest</span>
    <span class="c1"># to the desired variance.</span>
    <span class="c1"># These two are then taken as the real and imaginary noise components</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">var_discrepancies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">nrandom</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
        <span class="n">var_discrepancies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span>

    <span class="c1"># Determine which instance&#39;s variance is the closest to the desired</span>
    <span class="c1"># variance</span>
    <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">var_discrepancies</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># The noise is constructed from the two closest arrays in a variance-sense</span>
    <span class="c1"># to the desired SNR</span>
    <span class="k">return</span> <span class="n">instances</span><span class="p">[</span><span class="n">first</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">instances</span><span class="p">[</span><span class="n">second</span><span class="p">]</span></div>


<div class="viewcode-block" id="generate_random_signal"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.generate_random_signal">[docs]</a><span class="k">def</span> <span class="nf">generate_random_signal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A convienince function to generate a synthetic FID with random</span>
<span class="sd">    parameters for testing purposes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    m : int</span>
<span class="sd">        Number of oscillators</span>

<span class="sd">    n : [int] or [int, int]</span>
<span class="sd">        Number of points in each dimension</span>

<span class="sd">    sw : [float] or [float, float]</span>
<span class="sd">        Sweep width in each dimension</span>

<span class="sd">    offset : [float], [float, float] or None, deafult: None</span>
<span class="sd">        Transmitter offset in each dimension</span>

<span class="sd">    snr : float or None, default: None</span>
<span class="sd">        Signal-to-noise ratio (dB)</span>

<span class="sd">    fid : numpy.ndarray</span>
<span class="sd">        The synthetic FID.</span>

<span class="sd">    tp : [numpy.ndarray], [numpy.ndarray, numpy.ndarray]</span>
<span class="sd">        The time points the FID is sampled at in each dimension.</span>

<span class="sd">    parameters : numpy.ndarray</span>
<span class="sd">        Parameters used to construct the signal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">n should be an iterable</span><span class="si">{</span><span class="n">cols</span><span class="o">.</span><span class="n">END</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>

    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_int&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;int_list&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;float_list&#39;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">snr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">snr</span><span class="p">,</span> <span class="s1">&#39;snr&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_float&#39;</span><span class="p">))</span>

    <span class="n">ArgumentChecker</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>

    <span class="c1"># low: 0.0, high: 1.0</span>
    <span class="c1"># amplitdues</span>
    <span class="n">para</span> <span class="o">=</span> <span class="n">nrandom</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    <span class="c1"># phases</span>
    <span class="n">para</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">para</span><span class="p">,</span> <span class="n">nrandom</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">m</span><span class="p">)))</span>
    <span class="c1"># frequencies</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">nrandom</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">s</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">s</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
         <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="p">)]</span>
    <span class="n">para</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">para</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="p">))</span>
    <span class="c1"># damping</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="p">[</span><span class="n">nrandom</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
    <span class="n">para</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">para</span><span class="p">,</span> <span class="o">*</span><span class="n">eta</span><span class="p">))</span>
    <span class="n">para</span> <span class="o">=</span> <span class="n">para</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="o">*</span><span class="n">make_fid</span><span class="p">(</span><span class="n">para</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">snr</span><span class="p">),</span> <span class="n">para</span></div>


<div class="viewcode-block" id="oscillator_integral"><a class="viewcode-back" href="../../references/sig.html#nmrespy.sig.oscillator_integral">[docs]</a><span class="k">def</span> <span class="nf">oscillator_integral</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the (absolute) integral of the Fourier transform of</span>
<span class="sd">    an oscillator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parameters : numpy.ndarray</span>
<span class="sd">        Oscillator parameters of the following form:</span>

<span class="sd">        * **1-dimensional data:**</span>

<span class="sd">          .. code:: python</span>

<span class="sd">             parameters = numpy.array([a, φ, f, η])</span>

<span class="sd">        * **2-dimensional data:**</span>

<span class="sd">          .. code:: python</span>

<span class="sd">             parameters = numpy.array([a, φ, f1, f2, η1, η2])</span>

<span class="sd">    n : [int], [int, int]</span>
<span class="sd">        Number of points to construct signal from in each dimension.</span>

<span class="sd">    sw : [float], [float, float]</span>
<span class="sd">        Sweep width in each dimension, in Hz.</span>

<span class="sd">    offset : [float], [float, float], or None, default: None</span>
<span class="sd">        Transmitter offset frequency in each dimension, in Hz. If set to</span>
<span class="sd">        `None`, the offset frequency will be set to 0Hz in each dimension.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    integral :</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The integration is performed using the composite Simpsons rule, provided</span>
<span class="sd">    by `scipy.integrate.simpson &lt;https://docs.scipy.org/doc/scipy/reference/\</span>
<span class="sd">    generated/scipy.integrate.simpson.html#scipy.integrate.simpson&gt;`_</span>

<span class="sd">    Spacing of points along the frequency axes is set a `1` (i.e. `dx = 1`).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fid</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">make_fid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">ft</span><span class="p">(</span><span class="n">fid</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">integral</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">integral</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="n">integral</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">integral</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.sig</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Simon Hulse &amp; Mohammadali Foroozandeh.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>